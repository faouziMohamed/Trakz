<mat-sidenav-container class="h-full">
  <mat-sidenav
    #drawer
    [attr.role]="(isHandset$ | async) ? 'dialog' : 'navigation'"
    [mode]="(isHandset$ | async) ? 'over' : 'side'"
    [opened]="(isHandset$ | async) === false"
    class="w-[12.5rem] !px-2 border-0 bg-inherit"
    fixedInViewport
  >
    <div class="bg-inherit flex pt-4 pb-2 gap-2 !flex-col">
      <div class="flex w-full gap-4">
        <button
          (click)="drawer.toggle()"
          aria-label="Toggle sidenav"
          mat-icon-button
          type="button"
        >
          <mat-icon aria-label="Side nav toggle icon">menu</mat-icon>
        </button>
        <a class="flex gap-2 items-center" routerLink="">
          <app-trakz-logo className=" w-[1.5rem] h-[1.5rem]"></app-trakz-logo>
          <h1 class="!text-xl !m-0">Trakz</h1>
        </a>
      </div>
      <mat-divider></mat-divider>
      <app-user-avatar [email]="email" [name]="name" [picture]="picture">
      </app-user-avatar>
    </div>
    <mat-divider></mat-divider>
    <mat-nav-list
      class="w-full !flex flex-col gap-1 nav-links"
      id="nav-link-list"
    >
      <button
        #rla="routerLinkActive"
        *ngFor="let nav of navLinks"
        [attr.aria-label]="nav.label"
        [ngClass]="rla.isActive ? '!bg-gray-100' : ''"
        [routerLink]="nav.link"
        [title]="nav.label"
        class="relative !h-[2.5rem] p-0 rounded-md !w-full flex items-center h-full"
        mat-list-item
        routerLinkActive=""
      >
        <span
          [ngClass]="rla.isActive ? 'block' : 'hidden'"
          class="absolute left-4 h-1/2 -ml-3 rounded bg-blue-600 w-1"
        >
        </span>
        <mat-icon
          aria-hidden="true"
          class="!text-[0.88rem] !w-[0.88rem] !h-[0.88rem]"
          matListIcon
        >
          {{ nav.icon }}
        </mat-icon>
        <div class="text-sm flex justify-between w-full">
          {{ nav.label }}
          <mat-chip
            *ngIf="nav.count"
            class="text-xs rounded-full w-fit h-[1rem] flex items-center justify-center p-2"
          >
            {{ nav.count }}
          </mat-chip>
        </div>
      </button>
    </mat-nav-list>
  </mat-sidenav>

  <mat-sidenav-content class="rounded-2xl bg-gray-100">
    <mat-toolbar
      [ngClass]="
        (isHandset$ | async) || !drawer.opened
          ? 'justify-between'
          : 'justify-end'
      "
      class="flex items-center bg-transparent"
    >
      <button
        (click)="drawer.toggle()"
        *ngIf="(isHandset$ | async) || !drawer.opened"
        aria-label="Toggle sidenav"
        mat-icon-button
        type="button"
      >
        <mat-icon aria-label="Side nav toggle icon">menu</mat-icon>
      </button>
      <button
        [matMenuTriggerFor]="notificationMenu"
        aria-label="Notifications"
        mat-icon-button
      >
        <mat-icon
          [matBadgeHidden]="!notifications.length"
          [matBadgeOverlap]="true"
          [matBadge]="notifications.length"
          matBadgeColor="warn"
          matBadgeSize="small"
          >notifications
        </mat-icon>
      </button>
      <mat-menu #notificationMenu="matMenu" class="gap-2">
        <button
          (click)="onNotificationClick(notification)"
          *ngFor="let notification of notifications"
          class="!flex relative !py-1 w-full items-center !leading-normal !h-auto justify-between"
          mat-menu-item
        >
          <div class="flex flex-col truncate">
            <h4 class="!m-0 !font-[500] !text-[0.78rem]">
              {{ notification.title }}
            </h4>
            <span class="w-full text-gray-500 truncate italic text-[0.70rem]">
              {{ notification.message }}
            </span>
          </div>
          <div>
            <mat-icon
              *ngIf="!notification.read"
              aria-hidden="true"
              class="text-sm {{ notification.type }}  !w-[0.875rem] !mr-0"
            >
              fiber_manual_record
            </mat-icon>
          </div>
        </button>
      </mat-menu>
    </mat-toolbar>
    <ng-content></ng-content>
  </mat-sidenav-content>
</mat-sidenav-container>
